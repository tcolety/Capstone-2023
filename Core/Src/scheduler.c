/*
 * scheduler.c
 *
 *  Created on: Mar 14, 2023
 *      Author: tcole
 */


//***********************************************************************************
// Include files
//***********************************************************************************
#include "scheduler.h"

//***********************************************************************************
// defined files
//***********************************************************************************


//***********************************************************************************
// Private variables
//***********************************************************************************
static unsigned int event_scheduled;


//***********************************************************************************
// Private functions
//***********************************************************************************

//***********************************************************************************
// Global functions
//***********************************************************************************


/***************************************************************************//**
 * @brief
 *          Function opens the scheduler
 *
 ******************************************************************************/
void scheduler_open(void){
  HAL_NVIC_DisableIRQ();
  event_scheduled = 0;
  HAL_NVIC_EnableIRQ();
}

/***************************************************************************//**
 * @brief
 *          Function adds an event to the schedule
 *
 ******************************************************************************/
void add_scheduled_event(uint32_t event){
	HAL_NVIC_DisableIRQ();
	event_scheduled |= event;
	HAL_NVIC_EnableIRQ();
}

/***************************************************************************//**
 * @brief
 *          Function removes an event from the schedule
 *
 ******************************************************************************/
void remove_scheduled_event(uint32_t event){
	HAL_NVIC_DisableIRQ();
	event_scheduled &= ~event;
	HAL_NVIC_EnableIRQ();
}

/***************************************************************************//**
 * @brief
 *          Function returns integer storing scheduled events
 *
 ******************************************************************************/
uint32_t get_scheduled_events(void){
  //CORE_DECLARE_IRQ_STATE;
  //CORE_ENTER_CRITICAL();
  return event_scheduled;
  //CORE_EXIT_CRITICAL();
}
